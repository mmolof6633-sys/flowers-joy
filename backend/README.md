# Flowers Joy Backend API

Backend API –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ —Ü–≤–µ—Ç–æ–≤ –≤ –ú–æ—Å–∫–≤–µ (delivery-only).

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **TypeScript** - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript
- **Express.js** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **MongoDB + Mongoose** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **JWT** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Zod** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Swagger** - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- MongoDB 7+ (–∏–ª–∏ Docker)
- npm –∏–ª–∏ yarn

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É backend:**

```bash
cd backend
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
npm install
```

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:**

```bash
cp .env.example .env
```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:**

```env
PORT=3000
NODE_ENV=development
MONGODB_URI=mongodb://localhost:27017/flowers-joy
JWT_SECRET=your-super-secret-jwt-key
JWT_EXPIRE=7d
ADMIN_EMAIL=admin@flowers-joy.ru
ADMIN_PASSWORD=admin123
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–∞—è MongoDB

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MongoDB –∑–∞–ø—É—â–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 27017.

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ MongoDB
docker-compose -f docker-compose.dev.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose -f docker-compose.dev.yml down
```

## üå± –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
npm run admin-seed
```

–°–æ–∑–¥–∞—Å—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å email –∏ –ø–∞—Ä–æ–ª–µ–º –∏–∑ `.env`.

### 2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –±—É–∫–µ—Ç—ã)

```bash
npm run seed
```

–°–æ–∑–¥–∞—Å—Ç:

- 9 –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–í–°–ï, –ê–í–¢–û–†–°–ö–ò–ï –ë–£–ö–ï–¢–´, –ú–û–ù–û–ë–£–ö–ï–¢–´, –ö–û–†–û–ë–ö–ê, –ö–û–†–ó–ò–ù–ê, –î–£–û&–¢–†–ò–û, –ù–ï–í–ï–°–¢–´, –ò–ù–¢–ï–†–¨–ï–†, –°–ï–ó–û–ù)
- 20 –±—É–∫–µ—Ç–æ–≤ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤ 2-3 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö, —Ü–µ–Ω—ã 1500-8000‚ÇΩ)

## üèÉ –ó–∞–ø—É—Å–∫

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
npm run dev
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3000` —Å hot-reload.

### Production

```bash
npm run build
npm start
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:

```
http://localhost:3000/api-docs
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
POST /api/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "phone": "+79991234567"
}
```

### –í—Ö–æ–¥

```bash
POST /api/auth/login
Content-Type: application/json

{
  "email": "admin@flowers-joy.ru",
  "password": "admin123"
}
```

–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç JWT —Ç–æ–∫–µ–Ω:

```json
{
  "success": true,
  "data": {
    "user": { ... },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–ø—Ä–æ—Å—ã:

```
Authorization: Bearer <your-token>
```

## üì° API Endpoints

### Public API

#### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

- `GET /api/categories` - –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `GET /api/categories/:slug` - –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å –±—É–∫–µ—Ç–∞–º–∏

#### –ë—É–∫–µ—Ç—ã

- `GET /api/bouquets` - –ö–∞—Ç–∞–ª–æ–≥ –±—É–∫–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - `category` - slug –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    - `minPrice` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    - `maxPrice` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    - `inStock` - –≤ –Ω–∞–ª–∏—á–∏–∏ (true/false)
    - `tags` - —Ç–µ–≥–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
    - `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    - `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    - `sort` - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (price-asc, price-desc, name-asc, name-desc, sortOrder)

- `GET /api/bouquets/:slug` - –î–µ—Ç–∞–ª–∏ –±—É–∫–µ—Ç–∞

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# –í—Å–µ –±—É–∫–µ—Ç—ã
GET /api/bouquets

# –ë—É–∫–µ—Ç—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–∫–æ—Ä–æ–±–∫–∞"
GET /api/bouquets?category=korobka

# –ë—É–∫–µ—Ç—ã –æ—Ç 2000‚ÇΩ –¥–æ 5000‚ÇΩ
GET /api/bouquets?minPrice=2000&maxPrice=5000

# –ë—É–∫–µ—Ç—ã –≤ –Ω–∞–ª–∏—á–∏–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ —Ü–µ–Ω–µ
GET /api/bouquets?inStock=true&sort=price-asc
```

### Admin API (—Ç—Ä–µ–±—É–µ—Ç JWT + —Ä–æ–ª—å admin)

#### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

- `POST /api/admin/categories` - –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- `GET /api/admin/categories` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
- `PATCH /api/admin/categories/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- `DELETE /api/admin/categories/:id` - –£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- `PATCH /api/admin/categories/reorder` - –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫

#### –ë—É–∫–µ—Ç—ã

- `POST /api/admin/bouquets` - –°–æ–∑–¥–∞—Ç—å –±—É–∫–µ—Ç
- `GET /api/admin/bouquets` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±—É–∫–µ—Ç–æ–≤
- `GET /api/admin/bouquets/:id` - –î–µ—Ç–∞–ª–∏ –±—É–∫–µ—Ç–∞
- `PATCH /api/admin/bouquets/:id` - –û–±–Ω–æ–≤–∏—Ç—å –±—É–∫–µ—Ç
- `DELETE /api/admin/bouquets/:id` - –£–¥–∞–ª–∏—Ç—å –±—É–∫–µ—Ç
- `PATCH /api/admin/bouquets/reorder` - –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –±—É–∫–µ—Ç–∞:**

```bash
POST /api/admin/bouquets
Authorization: Bearer <admin-token>
Content-Type: application/json

{
  "name": "–†–æ–∑—ã Cashmere",
  "price": 3500,
  "oldPrice": 4200,
  "images": ["https://example.com/image.jpg"],
  "categoryIds": ["64f...", "64g..."],
  "tags": ["—Ä–æ–∑—ã", "–ø—Ä–µ–º–∏—É–º"],
  "inStock": true,
  "sortOrder": 1,
  "description": "–†–æ—Å–∫–æ—à–Ω—ã–π –±—É–∫–µ—Ç –∏–∑ —Ä–æ–∑"
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
npm test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ watch —Ä–µ–∂–∏–º–µ
npm run test:watch
```

## üê≥ Docker

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ MongoDB
docker-compose -f docker-compose.dev.yml up -d
```

### Production

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ (MongoDB + Backend)
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes
docker-compose down -v
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (DB, Swagger)
‚îÇ   ‚îú‚îÄ‚îÄ controllers/      # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/        # Admin –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ public/       # Public –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ middleware/       # Middleware (auth, validation, errors)
‚îÇ   ‚îú‚îÄ‚îÄ models/           # Mongoose –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ routes/           # Express —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/        # Admin —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ public/       # Public —Ä–æ—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ scripts/          # Seed —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ validations/      # Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ server.ts         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ dist/                 # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker Compose –¥–ª—è production
‚îú‚îÄ‚îÄ docker-compose.dev.yml # Docker Compose –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

## üîë –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### Many-to-Many —Å–≤—è–∑—å

–ë—É–∫–µ—Ç—ã –º–æ–≥—É—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- –ë—É–∫–µ—Ç "–†–æ–∑—ã Cashmere" ‚Üí `authorskie`, `monobukety`, `nevesty`
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –±—É–∫–µ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ populate –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `categoryIds`

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è slug

Slug –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏:

- "–ê–í–¢–û–†–°–ö–ò–ï –ë–£–ö–ï–¢–´" ‚Üí `authorskie`
- "–†–æ–∑—ã Cashmere" ‚Üí `rozy-cashmere`

### –í–∞–ª–∏–¥–∞—Ü–∏—è

–í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—ã –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

## üöß –ë—É–¥—É—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

- [ ] –ö–æ—Ä–∑–∏–Ω–∞ (Cart API)
- [ ] –ó–∞–∫–∞–∑—ã (Order API)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex.Kassa
- [ ] SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus)

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

ISC

## üë§ –ê–≤—Ç–æ—Ä

Backend –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ —Ü–≤–µ—Ç–æ–≤ Flowers Joy
